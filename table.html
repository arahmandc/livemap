<!DOCTYPE html>
<html>
<head>
    <title>Data Table</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"/>

    <style>
        ul {
            margin-left:300px;
             list-style-type: none;
             margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #333;
            }

        li {
            float: left;
            }

        li a {
            display: block;
            color: white;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
            }

        li a:hover {
            text-decoration: none;
        background-color: #111;
        color: red;
        }




#customers {
  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

#customers td, #customers th {
    width: 300px;
  border: 1px solid #ddd;
  padding: 8px;
}

#customers tr:nth-child(even){background-color: #f2f2f2;}

#customers tr:hover {background-color: #ddd;}

#customers th {
  padding-top: 12px;
  padding-bottom: 12px;
  text-align: center;
  background-color: #4CAF50;
  color: white;
}
    </style>
</head>
<body oncontextmenu="return false">
        
    
    <div>
        <div><h2 style="padding-left: 100px;">Geo Based Data Collection Platform</h2></div>
        <ul>
        <li style="padding-left: 900px"><a href="index.html">Home</a></li>
        <li><a href="table.html">Data Table</a></li>
        <li><a href="map.html">Map</a></li>
<!--         <li><a href="other.html">Others</a></li> -->
        </ul>
    </div>

    <div id="container" style="width:100%;">

        <h2 style="text-align:center;">Data Table</h2>
        <h5 style="text-align:center;">All Data Collect From Field Survey</h5>
        
    </div>

       <a href="#" id="test" onClick="javascript:fnExcelReport();" style="text-decoration: none;" "padding-left: 600px;">Export Excel</a>

    <!-- partial:index.partial.html -->
    <table id="customers">
    <tr>
        <th>location_name</th>
        <th>category</th>
        <th>level</th>
        <th>lat</th>
        <th>long</th>
    </tr>
    </table>




    <!-- partial -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.4.2/tabletop.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js'></script>
    <script  src="./script.js"></script>

    <script type="text/javascript">
        
    function fnExcelReport() {
    var tab_text = '<html xmlns:x="urn:schemas-microsoft-com:office:excel">';
    tab_text = tab_text + '<head><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>';

    tab_text = tab_text + '<x:Name>Sheet1</x:Name>';

    tab_text = tab_text + '<x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet>';
    tab_text = tab_text + '</x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body>';

    tab_text = tab_text + "<table border='1px'>";
    tab_text = tab_text + $('#customers').html();
    tab_text = tab_text + '</table></body></html>';

    var data_type = 'data:application/vnd.ms-excel';
    
    var ua = window.navigator.userAgent;
    var msie = ua.indexOf("MSIE ");
    
    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {
        if (window.navigator.msSaveBlob) {
            var blob = new Blob([tab_text], {
                type: "application/csv;charset=utf-8;"
            });
            navigator.msSaveBlob(blob, 'Data Table.xls');
        }
    } else {
        $('#test').attr('href', data_type + ', ' + encodeURIComponent(tab_text));
        $('#test').attr('download', 'Data Table.xls');
    }

}

    </script>


</body>
</html>
